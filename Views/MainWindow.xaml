
<Window x:Class="Tatehama_musen_PC.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Tatehama_musen_PC"
        xmlns:vm="clr-namespace:Tatehama_musen_PC.ViewModels"
        mc:Ignorable="d"
        x:Name="RootWindow"
        Title="Tatehama Musen" Height="480" Width="800"
        Closed="Window_Closed" Loaded="Window_Loaded">
    <Window.Resources>
        <Style TargetType="Button" x:Key="ImageButton">
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid Background="Black">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Menu Grid.Row="0">
            <MenuItem Header="_勤務地変更" Click="ChangeWorkLocationMenuItem_Click"/>
            <MenuItem Header="_設定">
                <MenuItem Header="_音声設定" Click="AudioSettingsMenuItem_Click"/>
            </MenuItem>
        </Menu>

        <Viewbox Grid.Row="1" Stretch="Uniform">
            <Canvas Width="800" Height="450">
                <Canvas.Background>
                    <ImageBrush ImageSource="/image/tetudoudenwa.png"/>
                </Canvas.Background>

                <ListView x:Name="CallList" Canvas.Left="51" Canvas.Top="83" Width="254" Height="331" Background="White" Foreground="Black" BorderBrush="Black" FontSize="16" SelectionChanged="CallList_SelectionChanged">
                </ListView>

                <TextBlock x:Name="CallTimerDisplay" 
                           Canvas.Left="381" Canvas.Top="180" Width="131" Height="30"
                           Text="00:00"
                           Foreground="Black" 
                           Background="White"
                           TextAlignment="Center"
                           FontSize="22"
                           Visibility="Collapsed"/>

                <TextBlock x:Name="NumberDisplay" 
                           Canvas.Left="381" Canvas.Top="211" Width="131" Height="43"
                           Background="White" 
                           Foreground="Black" 
                           TextAlignment="Center"
                           FontSize="30"
                           Padding="5,0"
                           Text="{Binding TenkeyViewModel.PhoneNumber}"/>

                <Canvas x:Name="KeypadCanvas" Canvas.Left="370" Canvas.Top="256">
                    <Button Canvas.Top="10.281" Canvas.Left="0" Width="51" Height="45" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="7"/>
                    <Button Canvas.Top="10.281" Canvas.Left="51" Width="51" Height="44" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="8"/>
                    <Button Canvas.Top="10.281" Canvas.Left="104.75" Width="50" Height="43" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="9"/>

                    <Button Canvas.Top="56.281" Canvas.Left="0" Width="48" Height="43" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="4"/>
                    <Button Canvas.Top="56.281" Canvas.Left="51" Width="51" Height="43" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="5"/>
                    <Button Canvas.Top="56.281" Canvas.Left="104.75" Width="49" Height="45" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="6"/>

                    <Button Canvas.Top="103.031" Canvas.Left="0" Width="48" Height="44" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="1"/>
                    <Button Canvas.Top="103.031" Canvas.Left="51" Width="51" Height="43" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="2"/>
                    <Button Canvas.Top="103.031" Canvas.Left="104.75" Width="49" Height="43" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="3"/>

                    <Button Canvas.Top="148.531" Canvas.Left="0" Width="51" Height="43" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.DeleteCommand}"/>
                    <Button Canvas.Top="148.531" Canvas.Left="51" Width="51" Height="43" Style="{StaticResource ImageButton}" BorderBrush="Transparent" Background="Transparent" Command="{Binding TenkeyViewModel.AddNumberCommand}" CommandParameter="0"/>
                </Canvas>

                <Canvas x:Name="FunctionButtonsCanvas" Canvas.Left="548" Canvas.Top="360">
                    <!-- 受話ボタン -->
                    <Button x:Name="jyuwaButton" Command="{Binding AnswerCommand}" Canvas.Left="0" Width="77" Height="80" BorderBrush="Transparent" Canvas.Top="10" Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="RootBorder">
                                    <Border.Background>
                                        <ImageBrush ImageSource="/image/jyuwa.png" Stretch="Fill"/>
                                    </Border.Background>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="RootBorder" Property="Background">
                                            <Setter.Value>
                                                <ImageBrush ImageSource="/image/jyuwa-kiro.png" Stretch="Fill"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                    <DataTrigger Binding="{Binding DataContext.CurrentCallState, ElementName=RootWindow}" Value="{x:Static vm:CallState.Ringing}">
                                        <DataTrigger.EnterActions>
                                            <BeginStoryboard Name="JyuwaBlinkStory">
                                                <Storyboard RepeatBehavior="Forever">
                                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RootBorder" Storyboard.TargetProperty="Background">
                                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.4">
                                                            <DiscreteObjectKeyFrame.Value>
                                                                <ImageBrush ImageSource="/image/jyuwa-ao.png" Stretch="Fill" />
                                                            </DiscreteObjectKeyFrame.Value>
                                                        </DiscreteObjectKeyFrame>
                                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.8">
                                                            <DiscreteObjectKeyFrame.Value>
                                                                <ImageBrush ImageSource="/image/jyuwa.png" Stretch="Fill" />
                                                            </DiscreteObjectKeyFrame.Value>
                                                        </DiscreteObjectKeyFrame>
                                                    </ObjectAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </DataTrigger.EnterActions>
                                        <DataTrigger.ExitActions>
                                            <StopStoryboard BeginStoryboardName="JyuwaBlinkStory"/>
                                        </DataTrigger.ExitActions>
                                    </DataTrigger>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding DataContext.CurrentCallState, ElementName=RootWindow}" Value="{x:Static vm:CallState.InCall}"/>
                                            <Condition Binding="{Binding DataContext.IsOutgoingCall, ElementName=RootWindow}" Value="False"/>
                                        </MultiDataTrigger.Conditions>
                                        <Setter TargetName="RootBorder" Property="Background">
                                            <Setter.Value>
                                                <ImageBrush ImageSource="/image/jyuwa-ao.png" Stretch="Fill"/>
                                            </Setter.Value>
                                        </Setter>
                                    </MultiDataTrigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <!-- 発信ボタン -->
                    <Button x:Name="hashinButton" Command="{Binding CallCommand}" Canvas.Left="77" Width="77" Height="80" BorderBrush="Transparent" Canvas.Top="10" Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="RootBorder">
                                    <Border.Background>
                                        <ImageBrush ImageSource="/image/hashin.png" Stretch="Fill"/>
                                    </Border.Background>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="RootBorder" Property="Background">
                                            <Setter.Value>
                                                <ImageBrush ImageSource="/image/hashin-kiro.png" Stretch="Fill"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                    <DataTrigger Binding="{Binding DataContext.CurrentCallState, ElementName=RootWindow}" Value="{x:Static vm:CallState.ReadyToCall}">
                                        <DataTrigger.EnterActions>
                                            <BeginStoryboard Name="HashinBlinkStory">
                                                <Storyboard RepeatBehavior="Forever">
                                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RootBorder" Storyboard.TargetProperty="Background">
                                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.4">
                                                            <DiscreteObjectKeyFrame.Value>
                                                                <ImageBrush ImageSource="/image/hashin-ao.png" Stretch="Fill" />
                                                            </DiscreteObjectKeyFrame.Value>
                                                        </DiscreteObjectKeyFrame>
                                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.8">
                                                            <DiscreteObjectKeyFrame.Value>
                                                                <ImageBrush ImageSource="/image/hashin.png" Stretch="Fill" />
                                                            </DiscreteObjectKeyFrame.Value>
                                                        </DiscreteObjectKeyFrame>
                                                    </ObjectAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </DataTrigger.EnterActions>
                                        <DataTrigger.ExitActions>
                                            <StopStoryboard BeginStoryboardName="HashinBlinkStory"/>
                                        </DataTrigger.ExitActions>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding DataContext.CurrentCallState, ElementName=RootWindow}" Value="{x:Static vm:CallState.Calling}">
                                        <Setter TargetName="RootBorder" Property="Background">
                                            <Setter.Value>
                                                <ImageBrush ImageSource="/image/hashin-ao.png" Stretch="Fill"/>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding DataContext.CurrentCallState, ElementName=RootWindow}" Value="{x:Static vm:CallState.InCall}">
                                        <Setter TargetName="RootBorder" Property="Background">
                                            <Setter.Value>
                                                <ImageBrush ImageSource="/image/hashin-ao.png" Stretch="Fill"/>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <!-- 終話ボタン -->
                    <Button x:Name="syuwaButton" Command="{Binding HangUpCommand}" Canvas.Left="154" Width="77" Height="80" BorderBrush="Transparent" Canvas.Top="10" Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="RootBorder">
                                    <Border.Background>
                                        <ImageBrush ImageSource="/image/syuwa.png" Stretch="Fill"/>
                                    </Border.Background>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="RootBorder" Property="Background">
                                            <Setter.Value>
                                                <ImageBrush ImageSource="/image/syuwa-kiro.png" Stretch="Fill"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                    <DataTrigger Binding="{Binding DataContext.CurrentCallState, ElementName=RootWindow}" Value="{x:Static vm:CallState.Calling}">
                                        <Setter TargetName="RootBorder" Property="Background">
                                            <Setter.Value>
                                                <ImageBrush ImageSource="/image/syuwa-aka.png" Stretch="Fill"/>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding DataContext.CurrentCallState, ElementName=RootWindow}" Value="{x:Static vm:CallState.InCall}">
                                        <Setter TargetName="RootBorder" Property="Background">
                                            <Setter.Value>
                                                <ImageBrush ImageSource="/image/syuwa-aka.png" Stretch="Fill"/>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding DataContext.CurrentCallState, ElementName=RootWindow}" Value="{x:Static vm:CallState.Ringing}">
                                        <DataTrigger.EnterActions>
                                            <BeginStoryboard Name="SyuwaBlinkStory">
                                                <Storyboard RepeatBehavior="Forever">
                                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="RootBorder" Storyboard.TargetProperty="Background">
                                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.4">
                                                            <DiscreteObjectKeyFrame.Value>
                                                                <ImageBrush ImageSource="/image/syuwa-aka.png" Stretch="Fill" />
                                                            </DiscreteObjectKeyFrame.Value>
                                                        </DiscreteObjectKeyFrame>
                                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.8">
                                                            <DiscreteObjectKeyFrame.Value>
                                                                <ImageBrush ImageSource="/image/syuwa.png" Stretch="Fill" />
                                                            </DiscreteObjectKeyFrame.Value>
                                                        </DiscreteObjectKeyFrame>
                                                    </ObjectAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </DataTrigger.EnterActions>
                                        <DataTrigger.ExitActions>
                                            <StopStoryboard BeginStoryboardName="SyuwaBlinkStory"/>
                                        </DataTrigger.ExitActions>
                                    </DataTrigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <!-- 着信シミュレートボタン -->
                    <Button x:Name="simulateIncomingCallButton" Command="{Binding SimulateIncomingCallCommand}" Canvas.Left="231" Width="77" Height="80" BorderBrush="Transparent" Canvas.Top="10" Cursor="Hand" Content="Simulate Call"/>
                </Canvas>

            </Canvas>
        </Viewbox>
        
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Text="{Binding ConnectionStatus}"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
